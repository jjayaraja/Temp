Connect-PnPOnline -Url $siteUrl -Interactive

$log = @()

$items = Get-PnPListItem -List $listName -PageSize 500 -Fields "Id","HasUniqueRoleAssignments","FileRef"

foreach ($item in $items) {
    if ($item.FieldValues["HasUniqueRoleAssignments"]) {
        Set-PnPListItemPermission -List $listName -Identity $item.Id -InheritPermissions
        $log += [pscustomobject]@{Id = $item.Id; Path = $item.FieldValues["FileRef"]; Status = "Reset"}
    } else {
        $log += [pscustomobject]@{Id = $item.Id; Path = $item.FieldValues["FileRef"]; Status = "Inherited"}
    }
}

$log | Export-Csv -Path "inheritance-results.csv" -NoTypeInformation
