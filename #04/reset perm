# Configuration
$siteUrl     = "https://yourtenant.sharepoint.com/sites/yoursite"
$listName    = "Documents"  # change to your library name

# Connect
Connect-PnPOnline -Url $siteUrl -Interactive
$ctx = Get-PnPContext

# Get all items (files+folders)
$items = Get-PnPListItem -List $listName -PageSize 500 -Fields FileRef, FileSystemObjectType, HasUniqueRoleAssignments

foreach ($item in $items) {
    $hasUnique = $item.FieldValues["HasUniqueRoleAssignments"]
    $path      = $item.FieldValues["FileRef"]

    if ($hasUnique) {
        Write-Host "ðŸ”„ Resetting inheritance on: $path"
        $item.ResetRoleInheritance()
        $item.Update()
        $ctx.ExecuteQuery()
    }
}
